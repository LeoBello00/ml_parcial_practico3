
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fraud detection &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exo2_fraud';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial practico 3
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="exo1_cancer.html">Ejercicio 1: Breast cancer</a></li>
<li class="toctree-l1"><a class="reference internal" href="exo1_housing.html">Ejercicio 1: Boston Housing</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexo2_fraud.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/exo2_fraud.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Fraud detection</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimension-reduction">Dimension reduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding">Encoding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputation">Imputation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-multicolinearity-with-vif-on-a-sample">Delete multicolinearity with VIF on a sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histplot">Histplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fraud-detection">
<h1>Fraud detection<a class="headerlink" href="#fraud-detection" title="Link to this heading">#</a></h1>
<section id="load-data">
<h2>Load data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_fraud</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud.csv&#39;</span><span class="p">)</span>
<span class="n">df_fraud</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.5</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.0</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.0</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.0</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.0</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>samsung browser 6.2</td>
      <td>32.0</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2987005</td>
      <td>0</td>
      <td>86510</td>
      <td>49.0</td>
      <td>W</td>
      <td>5937</td>
      <td>555.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2987006</td>
      <td>0</td>
      <td>86522</td>
      <td>159.0</td>
      <td>W</td>
      <td>12308</td>
      <td>360.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2987007</td>
      <td>0</td>
      <td>86529</td>
      <td>422.5</td>
      <td>W</td>
      <td>12695</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2987008</td>
      <td>0</td>
      <td>86535</td>
      <td>15.0</td>
      <td>H</td>
      <td>2803</td>
      <td>100.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>mobile safari 11.0</td>
      <td>32.0</td>
      <td>1334x750</td>
      <td>match_status:1</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>iOS Device</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2987009</td>
      <td>0</td>
      <td>86536</td>
      <td>117.0</td>
      <td>W</td>
      <td>17399</td>
      <td>111.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 434 columns</p>
</div></div></div>
</div>
<section id="missing-values">
<h3>Missing values<a class="headerlink" href="#missing-values" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">utils</span>
<span class="n">utils</span><span class="o">.</span><span class="n">print_percentage_missing_values</span><span class="p">(</span><span class="n">df_fraud</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing values: 115523073 (45.1%)
</pre></div>
</div>
</div>
</div>
<p>We have a lot of missing values, more than 45%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_data_count</span> <span class="o">=</span> <span class="n">df_fraud</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing_data_percentage</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">missing_data_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_fraud</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">missing_data_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Missing data (count)&#39;</span><span class="p">:</span> <span class="n">missing_data_count</span><span class="p">,</span>
    <span class="s1">&#39;Missing data (%)&#39;</span><span class="p">:</span> <span class="n">missing_data_percentage</span>
<span class="p">})</span>

<span class="n">missing_data_stats</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Missing data (%)&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Missing data (count)</th>
      <th>Missing data (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_24</th>
      <td>585793</td>
      <td>99.2</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>585408</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_26</th>
      <td>585377</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_21</th>
      <td>585381</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_22</th>
      <td>585371</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_23</th>
      <td>585371</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_08</th>
      <td>585385</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_07</th>
      <td>585385</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>id_27</th>
      <td>585371</td>
      <td>99.1</td>
    </tr>
    <tr>
      <th>dist2</th>
      <td>552913</td>
      <td>93.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To eliminate missing values, we can start by eliminating columns with the highest number of missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">threshlods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">))</span>
<span class="n">percentage_missing_values</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">threshlods</span><span class="p">):</span>
    <span class="n">df_copy</span> <span class="o">=</span> <span class="n">df_fraud</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">missing_data_stats</span><span class="p">[</span><span class="n">missing_data_stats</span><span class="p">[</span><span class="s1">&#39;Missing data (%)&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">df_copy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns_to_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">percentage</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">percentage_missing_values</span><span class="p">(</span><span class="n">df_copy</span><span class="p">)</span>
    <span class="n">percentage_missing_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">percentage</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">threshlods</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">percentage_missing_values</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Percentage of missing values&#39;</span><span class="p">,</span>
                    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Threshold (%)&#39;</span><span class="p">,</span>
                    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Percentage of missing values&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/101 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 101/101 [01:36&lt;00:00,  1.05it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mi">47</span>
<span class="n">columns_to_drop</span> <span class="o">=</span> <span class="n">missing_data_stats</span><span class="p">[</span><span class="n">missing_data_stats</span><span class="p">[</span><span class="s1">&#39;Missing data (%)&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df_fraud</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns_to_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">print_percentage_missing_values</span><span class="p">(</span><span class="n">df_fraud</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing values: 10122995 (8.3%)
</pre></div>
</div>
</div>
</div>
<p>We have now around 8% of missing values</p>
</section>
<section id="dimension-reduction">
<h3>Dimension reduction<a class="headerlink" href="#dimension-reduction" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 206)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 206 entries, TransactionID to V321
dtypes: float64(194), int64(4), object(8)
memory usage: 928.1+ MB
</pre></div>
</div>
</div>
</div>
<p>We have 8 object columns, which we will need to convert to numerical columns.</p>
</section>
<section id="encoding">
<h3>Encoding<a class="headerlink" href="#encoding" title="Link to this heading">#</a></h3>
<p>To encode object data, we use a OneHotEncoder</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="n">object_df</span> <span class="o">=</span> <span class="n">df_fraud</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">encoded_data</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">object_df</span><span class="p">)</span>

<span class="n">categories</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">categories_</span>

<span class="n">encoded_columns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">object_df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">encoded_columns</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:]])</span>

<span class="n">encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoded_columns</span><span class="p">)</span>

<span class="n">df_fraud</span> <span class="o">=</span> <span class="n">df_fraud</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">object_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_fraud</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_fraud</span><span class="p">,</span> <span class="n">encoded_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 277)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_cleaned.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we have 277 <a class="reference external" href="http://columns.To">columns.To</a> eliminate the multicolinearity, we need to impute the data to calculate the VIF. For this, we will use IterativeImputer.</p>
</section>
</section>
<section id="imputation">
<h2>Imputation<a class="headerlink" href="#imputation" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_fraud</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_cleaned.csv&#39;</span><span class="p">)</span>
<span class="n">df_fraud</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>...</th>
      <th>P_emaildomain_ymail.com</th>
      <th>P_emaildomain_nan</th>
      <th>M1_T</th>
      <th>M1_nan</th>
      <th>M2_T</th>
      <th>M2_nan</th>
      <th>M3_T</th>
      <th>M3_nan</th>
      <th>M6_T</th>
      <th>M6_nan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.5</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.0</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.0</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.0</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.0</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 277 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">n_nearest_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">imputer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_fraud</span><span class="p">)</span>
<span class="n">df_fraud_imputed</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_fraud</span><span class="p">)</span>
<span class="n">df_fraud_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_fraud_imputed</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_fraud</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_imputed</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_imputed.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can reduce again the dimension eliminating multicolinearity. To do this, we are going to use the Variance Inflation Factor (VIF). A VIF higher than 10 reveals a high multicolinearity so we can delete these variables.</p>
<p>Calculating the VIF require a lot of time so we are going to use a random sample to eliminate the multicolinearity.</p>
<section id="delete-multicolinearity-with-vif-on-a-sample">
<h3>Delete multicolinearity with VIF on a sample<a class="headerlink" href="#delete-multicolinearity-with-vif-on-a-sample" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_fraud_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_imputed.csv&#39;</span><span class="p">)</span>
<span class="n">df_fraud_imputed</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>...</th>
      <th>P_emaildomain_ymail.com</th>
      <th>P_emaildomain_nan</th>
      <th>M1_T</th>
      <th>M1_nan</th>
      <th>M2_T</th>
      <th>M2_nan</th>
      <th>M3_T</th>
      <th>M3_nan</th>
      <th>M6_T</th>
      <th>M6_nan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000.0</td>
      <td>0.0</td>
      <td>86400.0</td>
      <td>68.5</td>
      <td>13926.0</td>
      <td>384.313069</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001.0</td>
      <td>0.0</td>
      <td>86401.0</td>
      <td>29.0</td>
      <td>2755.0</td>
      <td>404.000000</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002.0</td>
      <td>0.0</td>
      <td>86469.0</td>
      <td>59.0</td>
      <td>4663.0</td>
      <td>490.000000</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003.0</td>
      <td>0.0</td>
      <td>86499.0</td>
      <td>50.0</td>
      <td>18132.0</td>
      <td>567.000000</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004.0</td>
      <td>0.0</td>
      <td>86506.0</td>
      <td>50.0</td>
      <td>4497.0</td>
      <td>514.000000</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 277 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">size_sample</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">df_sampled</span> <span class="o">=</span> <span class="n">df_fraud_imputed</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">size_sample</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">delete_multicollinearity</span>

<span class="n">df_fraud_preprocessed</span> <span class="o">=</span> <span class="n">delete_multicollinearity</span><span class="p">(</span><span class="n">df_sampled</span><span class="p">,</span> <span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">#1h10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dropped column card6_nan with VIF: inf (41s)
Dropped column M3_nan with VIF: inf (37s)
Dropped column M2_nan with VIF: inf (43s)
Dropped column V307 with VIF: 195690558.9 (44s)
Dropped column V97 with VIF: 34966459.7 (40s)
Dropped column V308 with VIF: 13886833.8 (31s)
Dropped column V96 with VIF: 8241993.1 (40s)
Dropped column V306 with VIF: 4630651.0 (42s)
Dropped column V280 with VIF: 2969670.4 (35s)
Dropped column V95 with VIF: 2017474.1 (34s)
Dropped column V305 with VIF: 1441567.2 (33s)
Dropped column V65 with VIF: 51729782.8 (66s)
Dropped column V41 with VIF: 6177709.8 (68s)
Dropped column V14 with VIF: 1225457.2 (65s)
Dropped column V128 with VIF: 1002481.8 (49s)
Dropped column V126 with VIF: 588742.8 (42s)
Dropped column V279 with VIF: 199070.9 (41s)
Dropped column TransactionID with VIF: 22340.0 (40s)
Dropped column V101 with VIF: 20786.5 (41s)
Dropped column V133 with VIF: 16898.5 (43s)
Dropped column C12 with VIF: 10485.8 (42s)
Dropped column V119 with VIF: 10089.5 (58s)
Dropped column V295 with VIF: 6535.5 (45s)
Dropped column V102 with VIF: 5752.6 (48s)
Dropped column V107 with VIF: 4573.1 (51s)
Dropped column V28 with VIF: 4381.4 (45s)
Dropped column C11 with VIF: 4071.5 (47s)
Dropped column card6_debit with VIF: 3151.2 (46s)
Dropped column V120 with VIF: 3132.6 (37s)
Dropped column C8 with VIF: 3120.4 (37s)
Dropped column V317 with VIF: 2918.5 (36s)
Dropped column V88 with VIF: 2481.1 (36s)
Dropped column V134 with VIF: 2298.0 (34s)
Dropped column addr2 with VIF: 2256.3 (36s)
Dropped column V111 with VIF: 2226.0 (44s)
Dropped column V117 with VIF: 1811.0 (46s)
Dropped column C4 with VIF: 1547.9 (36s)
Dropped column V108 with VIF: 1446.9 (36s)
Dropped column M1_T with VIF: 1362.3 (34s)
Dropped column V293 with VIF: 1105.1 (37s)
Dropped column V113 with VIF: 812.4 (34s)
Dropped column V118 with VIF: 792.4 (36s)
Dropped column V68 with VIF: 774.6 (33s)
Dropped column C10 with VIF: 662.5 (34s)
Dropped column V122 with VIF: 628.3 (33s)
Dropped column C6 with VIF: 563.5 (31s)
Dropped column V294 with VIF: 539.2 (31s)
Dropped column V116 with VIF: 506.7 (32s)
Dropped column C1 with VIF: 477.6 (33s)
Dropped column card3 with VIF: 400.7 (28s)
Dropped column V298 with VIF: 386.7 (28s)
Dropped column V110 with VIF: 360.3 (29s)
Dropped column V31 with VIF: 357.7 (29s)
Dropped column V132 with VIF: 329.0 (29s)
Dropped column V17 with VIF: 294.2 (29s)
Dropped column V46 with VIF: 277.9 (29s)
Dropped column P_emaildomain_gmail.com with VIF: 266.4 (28s)
Dropped column V292 with VIF: 238.4 (28s)
Dropped column V112 with VIF: 227.2 (31s)
Dropped column V25 with VIF: 225.4 (27s)
Dropped column V127 with VIF: 215.8 (26s)
Dropped column V58 with VIF: 209.1 (28s)
Dropped column V106 with VIF: 202.3 (28s)
Dropped column V114 with VIF: 201.5 (27s)
Dropped column C2 with VIF: 188.3 (27s)
Dropped column V93 with VIF: 186.3 (25s)
Dropped column V121 with VIF: 175.3 (26s)
Dropped column V103 with VIF: 171.0 (25s)
Dropped column V84 with VIF: 165.7 (26s)
Dropped column V71 with VIF: 152.6 (24s)
Dropped column V15 with VIF: 151.8 (24s)
Dropped column V23 with VIF: 143.7 (24s)
Dropped column V66 with VIF: 134.0 (25s)
Dropped column ProductCD_W with VIF: 131.8 (27s)
Dropped column V105 with VIF: 117.8 (34s)
Dropped column V123 with VIF: 115.8 (34s)
Dropped column V21 with VIF: 115.5 (31s)
Dropped column V109 with VIF: 113.9 (32s)
Dropped column V42 with VIF: 99.7 (31s)
Dropped column V77 with VIF: 96.1 (31s)
Dropped column C13 with VIF: 90.0 (35s)
Dropped column V136 with VIF: 86.6 (27s)
Dropped column V50 with VIF: 85.6 (27s)
Dropped column V59 with VIF: 79.7 (34s)
Dropped column V86 with VIF: 76.0 (23s)
Dropped column V37 with VIF: 69.4 (21s)
Dropped column V47 with VIF: 67.1 (20s)
Dropped column V90 with VIF: 66.5 (21s)
Dropped column V51 with VIF: 64.4 (20s)
Dropped column V16 with VIF: 62.2 (21s)
Dropped column V26 with VIF: 59.6 (22s)
Dropped column V82 with VIF: 57.2 (22s)
Dropped column V81 with VIF: 56.0 (21s)
Dropped column V125 with VIF: 54.5 (19s)
Dropped column V304 with VIF: 53.8 (20s)
Dropped column V72 with VIF: 52.0 (19s)
Dropped column V33 with VIF: 47.6 (20s)
Dropped column card4_visa with VIF: 46.9 (18s)
Dropped column V20 with VIF: 46.6 (18s)
Dropped column V48 with VIF: 46.3 (18s)
Dropped column V44 with VIF: 45.0 (18s)
Dropped column V115 with VIF: 44.3 (17s)
Dropped column V61 with VIF: 42.1 (17s)
Dropped column V64 with VIF: 42.1 (17s)
Dropped column V89 with VIF: 38.7 (16s)
Dropped column V74 with VIF: 38.6 (15s)
Dropped column V29 with VIF: 37.5 (19s)
Dropped column V92 with VIF: 36.7 (22s)
Dropped column V137 with VIF: 36.4 (20s)
Dropped column V24 with VIF: 35.7 (15s)
Dropped column V55 with VIF: 34.9 (15s)
Dropped column V39 with VIF: 34.4 (14s)
Dropped column V18 with VIF: 32.8 (14s)
Dropped column V94 with VIF: 32.3 (16s)
Dropped column V67 with VIF: 31.0 (14s)
Dropped column V299 with VIF: 30.9 (14s)
Dropped column V76 with VIF: 29.8 (13s)
Dropped column V70 with VIF: 28.9 (13s)
Dropped column V78 with VIF: 27.5 (18s)
Dropped column V85 with VIF: 26.4 (14s)
Dropped column V57 with VIF: 24.8 (13s)
Dropped column V287 with VIF: 24.3 (12s)
Dropped column V302 with VIF: 24.0 (13s)
Dropped column V54 with VIF: 23.4 (16s)
Dropped column card5 with VIF: 22.8 (13s)
Dropped column V315 with VIF: 22.6 (12s)
Dropped column V12 with VIF: 21.6 (12s)
Dropped column V87 with VIF: 19.1 (12s)
Dropped column V32 with VIF: 18.7 (16s)
Dropped column V35 with VIF: 18.3 (16s)
Dropped column V52 with VIF: 18.2 (15s)
Dropped column V320 with VIF: 17.9 (12s)
Dropped column V43 with VIF: 17.8 (14s)
Dropped column V91 with VIF: 17.7 (15s)
Dropped column V60 with VIF: 17.2 (15s)
Dropped column V290 with VIF: 15.8 (15s)
Dropped column V80 with VIF: 15.6 (14s)
Dropped column M2_T with VIF: 15.5 (14s)
Dropped column V131 with VIF: 15.0 (14s)
Dropped column V83 with VIF: 13.6 (14s)
Dropped column V45 with VIF: 13.3 (14s)
Dropped column V22 with VIF: 12.1 (14s)
Dropped column V49 with VIF: 12.1 (9s)
Dropped column V297 with VIF: 12.0 (13s)
Dropped column V318 with VIF: 11.8 (11s)
Dropped column V124 with VIF: 11.0 (11s)
Dropped column V129 with VIF: 10.9 (11s)
Dropped column V73 with VIF: 10.8 (9s)
Dropped column V79 with VIF: 10.5 (9s)
Dropped column V99 with VIF: 10.4 (15s)
Dropped column V321 with VIF: 10.1 (15s)
Dropped column V19 with VIF: 10.0 (11s)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns_to_keep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_fraud_preprocessed</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>
<span class="n">df_fraud_final</span> <span class="o">=</span> <span class="n">df_fraud_imputed</span><span class="p">[</span><span class="n">columns_to_keep</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_final.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraud_final</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 125)
</pre></div>
</div>
</div>
</div>
<p>Now we have 125 columns, to reduce more the dimension, we can see the correlation between each pair of predictors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_fraud_preprocessed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_final.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_fraud_preprocessed</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">upper_corr_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_upper_corr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">upper_corr_matrix</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_fraud_preprocessed</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df_fraud_preprocessed</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df_upper_corr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>addr1</th>
      <th>C3</th>
      <th>C5</th>
      <th>C7</th>
      <th>C9</th>
      <th>C14</th>
      <th>...</th>
      <th>P_emaildomain_yahoo.de</th>
      <th>P_emaildomain_yahoo.es</th>
      <th>P_emaildomain_yahoo.fr</th>
      <th>P_emaildomain_ymail.com</th>
      <th>P_emaildomain_nan</th>
      <th>M1_nan</th>
      <th>M3_T</th>
      <th>M6_T</th>
      <th>M6_nan</th>
      <th>isFraud</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionDT</th>
      <td>0.0</td>
      <td>0.01192</td>
      <td>0.010625</td>
      <td>0.019669</td>
      <td>0.000368</td>
      <td>0.007546</td>
      <td>0.023800</td>
      <td>0.055402</td>
      <td>0.032732</td>
      <td>0.039721</td>
      <td>...</td>
      <td>0.001303</td>
      <td>0.000323</td>
      <td>0.002424</td>
      <td>0.002764</td>
      <td>0.010070</td>
      <td>0.320819</td>
      <td>0.256185</td>
      <td>0.061788</td>
      <td>0.145946</td>
      <td>0.013103</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.005725</td>
      <td>0.016310</td>
      <td>0.009123</td>
      <td>0.004798</td>
      <td>0.030560</td>
      <td>0.017061</td>
      <td>0.030021</td>
      <td>0.022435</td>
      <td>...</td>
      <td>0.004016</td>
      <td>0.000641</td>
      <td>0.005700</td>
      <td>0.002554</td>
      <td>0.029072</td>
      <td>0.083438</td>
      <td>0.051949</td>
      <td>0.101604</td>
      <td>0.117025</td>
      <td>0.011320</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.004798</td>
      <td>0.020262</td>
      <td>0.004710</td>
      <td>0.005752</td>
      <td>0.004641</td>
      <td>0.004370</td>
      <td>0.007366</td>
      <td>...</td>
      <td>0.003322</td>
      <td>0.001902</td>
      <td>0.002009</td>
      <td>0.000784</td>
      <td>0.000410</td>
      <td>0.000016</td>
      <td>0.001681</td>
      <td>0.001479</td>
      <td>0.002465</td>
      <td>0.013640</td>
    </tr>
    <tr>
      <th>card2</th>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.028907</td>
      <td>0.007019</td>
      <td>0.019572</td>
      <td>0.008897</td>
      <td>0.024731</td>
      <td>0.001529</td>
      <td>...</td>
      <td>0.003105</td>
      <td>0.000110</td>
      <td>0.001372</td>
      <td>0.006144</td>
      <td>0.010675</td>
      <td>0.066961</td>
      <td>0.055356</td>
      <td>0.015828</td>
      <td>0.106776</td>
      <td>0.004082</td>
    </tr>
    <tr>
      <th>addr1</th>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.003233</td>
      <td>0.005938</td>
      <td>0.001495</td>
      <td>0.002641</td>
      <td>0.002636</td>
      <td>...</td>
      <td>0.000124</td>
      <td>0.002373</td>
      <td>0.000925</td>
      <td>0.001720</td>
      <td>0.005158</td>
      <td>0.020638</td>
      <td>0.016677</td>
      <td>0.024774</td>
      <td>0.032218</td>
      <td>0.006954</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 125 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">threshlods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">nb_col2drop</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">threshlods</span><span class="p">):</span>
    <span class="n">to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df_upper_corr</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">df_upper_corr</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)]</span>
    <span class="n">nb_col2drop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_drop</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">threshlods</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">nb_col2drop</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of columns to drop&#39;</span><span class="p">,</span>
                    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Threshold (%)&#39;</span><span class="p">,</span>
                    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Number of columns to drop&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/101 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 101/101 [00:00&lt;00:00, 245.12it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df_fraud_preprocessed</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_fraud_preprocessed</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">nb_components</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">variances</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">nb_components</span><span class="p">):</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
    <span class="n">variances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">nb_components</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">variances</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Explained variance ratio&#39;</span><span class="p">,</span>
                    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Number of components&#39;</span><span class="p">,</span>
                    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Explained variance ratio&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 19/19 [02:54&lt;00:00,  9.19s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb_components</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">nb_components</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>

<span class="n">df_pca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_pca</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_components</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">df_pca</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
      <th>PC4</th>
      <th>PC5</th>
      <th>PC6</th>
      <th>PC7</th>
      <th>PC8</th>
      <th>PC9</th>
      <th>PC10</th>
      <th>...</th>
      <th>PC27</th>
      <th>PC28</th>
      <th>PC29</th>
      <th>PC30</th>
      <th>PC31</th>
      <th>PC32</th>
      <th>PC33</th>
      <th>PC34</th>
      <th>PC35</th>
      <th>isFraud</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.251587</td>
      <td>-0.488764</td>
      <td>-1.411336</td>
      <td>-1.513690</td>
      <td>1.152828</td>
      <td>0.409959</td>
      <td>0.493672</td>
      <td>0.791833</td>
      <td>0.513962</td>
      <td>-0.155776</td>
      <td>...</td>
      <td>0.401492</td>
      <td>0.079803</td>
      <td>-0.034205</td>
      <td>0.276225</td>
      <td>-0.384662</td>
      <td>0.481998</td>
      <td>0.582489</td>
      <td>-0.300067</td>
      <td>-0.254769</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.304886</td>
      <td>-1.028321</td>
      <td>-0.219636</td>
      <td>-0.071615</td>
      <td>0.831524</td>
      <td>0.424945</td>
      <td>0.001436</td>
      <td>0.162295</td>
      <td>-0.427354</td>
      <td>-0.760685</td>
      <td>...</td>
      <td>0.004347</td>
      <td>0.151705</td>
      <td>-0.029141</td>
      <td>0.050761</td>
      <td>0.031968</td>
      <td>0.142299</td>
      <td>0.036609</td>
      <td>-0.035061</td>
      <td>-0.038671</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.240483</td>
      <td>-0.727944</td>
      <td>-1.691752</td>
      <td>-0.822673</td>
      <td>1.022479</td>
      <td>-0.181421</td>
      <td>0.234542</td>
      <td>-0.790251</td>
      <td>0.499296</td>
      <td>0.937267</td>
      <td>...</td>
      <td>1.146856</td>
      <td>-4.106451</td>
      <td>-1.567944</td>
      <td>1.147998</td>
      <td>-0.135984</td>
      <td>-0.475011</td>
      <td>-0.745876</td>
      <td>-0.703443</td>
      <td>-0.627332</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.471937</td>
      <td>1.511752</td>
      <td>1.114298</td>
      <td>-1.041947</td>
      <td>1.785683</td>
      <td>-1.213357</td>
      <td>0.554701</td>
      <td>-1.797466</td>
      <td>0.187887</td>
      <td>-0.080578</td>
      <td>...</td>
      <td>-0.344877</td>
      <td>-0.179451</td>
      <td>-0.006782</td>
      <td>0.053958</td>
      <td>0.014231</td>
      <td>-0.006990</td>
      <td>-0.081038</td>
      <td>-0.119090</td>
      <td>-0.070752</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-4.336551</td>
      <td>-0.892373</td>
      <td>0.318611</td>
      <td>0.093706</td>
      <td>0.550450</td>
      <td>0.235548</td>
      <td>0.438633</td>
      <td>0.104698</td>
      <td>-0.375216</td>
      <td>-0.948892</td>
      <td>...</td>
      <td>-0.055848</td>
      <td>-0.192107</td>
      <td>-0.423234</td>
      <td>0.205450</td>
      <td>-0.109095</td>
      <td>-0.026735</td>
      <td>-0.164722</td>
      <td>0.140223</td>
      <td>-0.238290</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pca</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/data_fraud_pca.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_fraud_preprocessed</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">abs</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3fa38173050c2602854a88b4e38fb8a1b835dddcf4d700a5c60b40e362898cf.png" src="_images/d3fa38173050c2602854a88b4e38fb8a1b835dddcf4d700a5c60b40e362898cf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_eda</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="s1">&#39;D10&#39;</span><span class="p">,</span> <span class="s1">&#39;D15&#39;</span><span class="p">,</span> <span class="s1">&#39;V12&#39;</span><span class="p">,</span> <span class="s1">&#39;V22&#39;</span><span class="p">,</span> <span class="s1">&#39;V30&#39;</span><span class="p">,</span> <span class="s1">&#39;V36&#39;</span><span class="p">,</span> <span class="s1">&#39;V40&#39;</span><span class="p">]</span>
<span class="n">data_eda</span> <span class="o">=</span> <span class="n">df_fraud_preprocessed</span><span class="p">[</span><span class="n">col_eda</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_eda</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D2</th>
      <th>D4</th>
      <th>D5</th>
      <th>D10</th>
      <th>D15</th>
      <th>V12</th>
      <th>V22</th>
      <th>V30</th>
      <th>V36</th>
      <th>V40</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>91.273735</td>
      <td>138.788598</td>
      <td>33.968343</td>
      <td>116.021565</td>
      <td>154.327641</td>
      <td>0.505598</td>
      <td>0.175581</td>
      <td>0.413451</td>
      <td>0.550874</td>
      <td>0.232755</td>
    </tr>
    <tr>
      <th>std</th>
      <td>154.674688</td>
      <td>174.496901</td>
      <td>62.737528</td>
      <td>172.740423</td>
      <td>190.323319</td>
      <td>0.497391</td>
      <td>0.357500</td>
      <td>0.520480</td>
      <td>0.482501</td>
      <td>0.491472</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-57.101829</td>
      <td>-419.230992</td>
      <td>-141.067547</td>
      <td>-136.326287</td>
      <td>-741.872495</td>
      <td>-0.489545</td>
      <td>-0.246607</td>
      <td>-0.243705</td>
      <td>-0.657509</td>
      <td>-0.265429</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.935475</td>
      <td>71.128466</td>
      <td>22.000000</td>
      <td>41.000000</td>
      <td>83.000000</td>
      <td>0.152209</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.438496</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>115.000000</td>
      <td>222.858328</td>
      <td>29.357035</td>
      <td>157.000000</td>
      <td>263.475069</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.050732</td>
    </tr>
    <tr>
      <th>max</th>
      <td>640.000000</td>
      <td>869.000000</td>
      <td>819.000000</td>
      <td>876.000000</td>
      <td>879.000000</td>
      <td>3.000000</td>
      <td>8.000000</td>
      <td>9.000000</td>
      <td>5.000000</td>
      <td>24.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The repartition of the values is very umbalanced. For exemple, for ‘V34’, we have the same 1st and 3rd quartile (0), which means that more than 75% of the values are equal to 0. The same goes for ‘V56’ and ‘V70’.</p>
</section>
<section id="histplot">
<h3>Histplot<a class="headerlink" href="#histplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_eda</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_eda</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/66318801921ce8014404682b0ab56830137e5c0b1921eff9dc216a90c9117e88.png" src="_images/66318801921ce8014404682b0ab56830137e5c0b1921eff9dc216a90c9117e88.png" />
</div>
</div>
<p>With these histoplot, we can validate that the data is very unbalanced. We can see that the data is very skewed and that the distribution is not normal. This can be because of the presence of outliers in the data. We can also see that the data is very sparse, with a lot of zeros in the data. This can be because of the presence of missing values in the data.</p>
<p>Let’s see if we have outliers with plot</p>
</section>
<section id="boxplot">
<h3>Boxplot<a class="headerlink" href="#boxplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_eda</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_eda</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Boxplot of </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/92cdeecd18464e4da56919f31368d96b126702e22e51106ee39de24ac15286d2.png" src="_images/92cdeecd18464e4da56919f31368d96b126702e22e51106ee39de24ac15286d2.png" />
</div>
</div>
<p>We these plots, we can see that the variables have a lot of outliers. This can be beacause of the missing values and the imputation with the IterativeImputer.
We will keep these outliers for now.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values">Missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimension-reduction">Dimension reduction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding">Encoding</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imputation">Imputation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#delete-multicolinearity-with-vif-on-a-sample">Delete multicolinearity with VIF on a sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histplot">Histplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">Boxplot</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>